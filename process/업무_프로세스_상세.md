# DocuGen (SI-Doc-Creator) 업무 프로세스 상세

## 목차
1. [시스템 개요](#1-시스템-개요)
2. [전체 아키텍처](#2-전체-아키텍처)
3. [사용자 관점 프로세스](#3-사용자-관점-프로세스)
4. [프로젝트 폴더 자동 분석](#4-프로젝트-폴더-자동-분석)
5. [템플릿별 자동 생성 프로세스](#5-템플릿별-자동-생성-프로세스)
6. [기술적 상세 프로세스](#6-기술적-상세-프로세스)
7. [문제 진단 체크리스트](#7-문제-진단-체크리스트)

---

## 1. 시스템 개요

### 1.1 시스템 목적
DocuGen은 SI 프로젝트를 위한 **문서 자동 생성 시스템**입니다. 프로젝트 정보를 입력하거나 기존 프로젝트 폴더를 분석하여 DOCX, PPTX, PDF 형식의 전문 문서를 자동으로 생성합니다.

### 1.2 핵심 기능
- **프로젝트 정보 관리**: 수동 입력 또는 폴더 자동 분석
- **템플릿 관리**: DOCX/PPTX 템플릿 업로드 및 플레이스홀더 추출
- **문서 생성**: 템플릿 기반 문서 자동 생성 (DOCX/PPTX/PDF)
- **다운로드/저장**: 생성된 문서 다운로드 또는 지정 폴더 저장

### 1.3 핵심 구성요소

```
┌─────────────────────────────────────────────────────────────────┐
│                        DocuGen 시스템                            │
├─────────────────────────────────────────────────────────────────┤
│  [Client]              [Server]              [Storage]          │
│  React + Vite    ←→    Express + TS    ←→   JSON File          │
│  TypeScript            Port: 4000           data/store.json    │
│  Tailwind CSS                                                   │
│  Port: 5173                                                     │
├─────────────────────────────────────────────────────────────────┤
│  [Services]                                                     │
│  ├── DataStore      : 프로젝트/템플릿 데이터 관리               │
│  ├── ProjectAnalyzer: 폴더 분석 및 정보 추출                    │
│  ├── TemplateParser : 플레이스홀더 추출                         │
│  └── Generators     : DOCX/PPTX/PDF 생성                        │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 전체 아키텍처

### 2.1 데이터 흐름도

```
┌──────────────┐     REST API      ┌──────────────┐      JSON       ┌──────────────┐
│   사용자      │  ─────────────▶  │    Server    │  ─────────────▶  │  DataStore   │
│  (브라우저)   │                  │  (Express)   │                  │ (store.json) │
└──────────────┘                   └──────────────┘                  └──────────────┘
       │                                  │
       │                                  ├──────────────────────┐
       │                                  ▼                      ▼
       │                           ┌──────────────┐      ┌──────────────┐
       │                           │  Generators  │      │  Analyzer    │
       │                           │ DOCX/PPTX/PDF│      │ (폴더 분석)  │
       │                           └──────────────┘      └──────────────┘
       │                                  │                      │
       │          파일 다운로드/저장       │     분석 결과 반환   │
       ◀──────────────────────────────────┴──────────────────────┘
```

### 2.2 디렉토리 구조

```
Prj_doc_creator/
├── client/                          # React 프론트엔드
│   └── src/
│       ├── pages/                   # 페이지 컴포넌트
│       │   ├── LoginPage.tsx        # 로그인
│       │   ├── HomePage.tsx         # 홈/대시보드
│       │   ├── ProjectsPage.tsx     # 프로젝트 목록
│       │   ├── ProjectFormPage.tsx  # 프로젝트 등록/수정
│       │   ├── AnalyzePage.tsx      # 프로젝트 폴더 분석 ⭐ 신규
│       │   ├── TemplatesPage.tsx    # 템플릿 관리
│       │   └── GeneratePage.tsx     # 문서 생성
│       ├── components/              # 공통 컴포넌트
│       │   ├── Layout.tsx           # 레이아웃
│       │   ├── DatePicker.tsx       # 날짜 선택기 ⭐ 신규
│       │   └── FolderPicker.tsx     # 폴더 선택기 ⭐ 신규
│       ├── contexts/
│       │   └── AuthContext.tsx      # 인증 컨텍스트
│       ├── services/
│       │   └── api.ts               # API 호출 함수
│       └── types/
│           └── index.ts             # 타입 정의
├── server/                          # Express 백엔드
│   └── src/
│       ├── routes/                  # API 엔드포인트
│       │   ├── projects.ts          # 프로젝트 CRUD
│       │   ├── templates.ts         # 템플릿 관리
│       │   ├── documents.ts         # 문서 생성
│       │   └── analyze.ts           # 폴더 분석 ⭐ 신규
│       ├── services/
│       │   ├── dataStore.ts         # JSON 기반 데이터 저장
│       │   ├── templateParser.ts    # 플레이스홀더 추출
│       │   └── projectAnalyzer.ts   # 프로젝트 폴더 분석 ⭐ 신규
│       ├── generators/
│       │   ├── docx/generator.ts    # DOCX 생성기
│       │   ├── pptx/generator.ts    # PPTX 생성기
│       │   └── pdf/generator.ts     # PDF 생성기
│       └── types/
│           └── index.ts             # 서버 타입 정의
├── data/
│   └── store.json                   # 프로젝트/템플릿 데이터
├── templates/
│   └── uploads/                     # 업로드된 템플릿 파일
└── process/                         # 프로세스 문서
    ├── 프로세스_플로우차트.md
    ├── 업무_프로세스_상세.md
    └── 트러블슈팅_가이드.md
```

---

## 3. 사용자 관점 프로세스

### 3.1 전체 워크플로우

```
┌─────────┐    ┌──────────────────────────────────┐    ┌─────────┐    ┌─────────┐
│  로그인  │───▶│        프로젝트 등록              │───▶│ 템플릿  │───▶│  문서   │
│         │    │  ┌──────────┐  ┌──────────┐     │    │  등록   │    │ 생성    │
└─────────┘    │  │ 수동 입력 │  │ 폴더 분석 │     │    └─────────┘    └─────────┘
               │  └──────────┘  └──────────┘     │           │             │
               └──────────────────────────────────┘           │             ▼
                                                              │       ┌─────────┐
                                                              └──────▶│다운로드 │
                                                                      │/저장    │
                                                                      └─────────┘
```

---

### 3.2 Step 1: 로그인

**URL**: `http://localhost:5173/login`

**절차**:
1. 브라우저에서 DocuGen URL 접속
2. 로그인 화면이 표시됨
3. 아이디/패스워드 입력 (기본: `admin` / `admin123`)
4. 로그인 버튼 클릭
5. 홈 화면으로 이동

**기술적 동작**:
```
클라이언트 (LoginPage.tsx)
    │
    ▼
sessionStorage에 인증 정보 저장
    │
    ▼
AuthContext에서 isAuthenticated = true 설정
    │
    ▼
보호된 라우트 접근 가능
```

---

### 3.3 Step 2-A: 프로젝트 수동 등록

**URL**: `http://localhost:5173/projects/new`

**절차**:
1. 사이드바에서 "프로젝트" 메뉴 클릭
2. "새 프로젝트" 버튼 클릭
3. 프로젝트 정보 입력:
   - 프로젝트명 (필수)
   - 고객사
   - 설명
   - 범위
   - 시작일 / 종료일
   - 상태 (진행중/완료/대기)
4. 팀원 추가 (이름, 역할, 담당업무)
5. 마일스톤 추가 (이름, 날짜, 산출물)
6. 요구사항 입력 (기능/비기능)
7. "저장" 버튼 클릭

**기술적 동작**:
```
클라이언트 (ProjectFormPage.tsx)
    │
    ├─── projectApi.create(projectData)
    │         │
    │         ▼
    │    POST /api/projects
    │         │
    │         ▼
    │    dataStore.createProject()
    │         │
    │         ▼
    │    store.json에 저장
    │
    ▼
프로젝트 목록으로 리다이렉트
```

**저장되는 데이터 구조**:
```json
{
  "id": "uuid-xxxxx",
  "name": "프로젝트명",
  "client": "고객사",
  "description": "설명",
  "scope": "범위",
  "startDate": "2024-01-01",
  "endDate": "2024-12-31",
  "status": "진행중",
  "team": [
    { "name": "홍길동", "role": "PM", "responsibility": "프로젝트 관리" }
  ],
  "milestones": [
    { "name": "착수", "date": "2024-01-15", "deliverables": "착수보고서" }
  ],
  "requirements": {
    "functional": [
      { "id": "FR-001", "category": "주요 기능", "description": "...", "priority": "high" }
    ],
    "nonFunctional": [
      { "id": "NFR-001", "category": "성능", "description": "...", "priority": "medium" }
    ]
  },
  "createdAt": "2024-01-01T00:00:00.000Z",
  "updatedAt": "2024-01-01T00:00:00.000Z"
}
```

---

### 3.4 Step 2-B: 프로젝트 폴더 자동 분석 (신규 기능)

**URL**: `http://localhost:5173/projects/analyze`

**절차**:
1. 사이드바에서 "프로젝트" 메뉴 클릭
2. "프로젝트 분석" 버튼 클릭
3. 폴더 브라우저에서 분석할 프로젝트 폴더 선택
   - 드라이브 선택 (C:, D: 등)
   - 폴더 탐색
   - "분석 시작" 버튼 클릭
4. 분석 결과 검토 및 수정
   - 기본 정보 (프로젝트명, 고객사, 설명 등)
   - 팀 구성 (추가/수정/삭제)
   - 마일스톤 (추가/수정/삭제)
5. "프로젝트로 저장" 버튼 클릭

**분석되는 파일들**:
| 파일명 | 추출 정보 |
|--------|-----------|
| `README.md` | 프로젝트명, 설명, 기능 목록 |
| `package.json` | 이름, 설명, 버전, 의존성, author, contributors |
| `PRD.md` | 개요, 목표, 기능 요구사항, 사용자 스토리, 범위 |
| `CLAUDE.md` | 프로젝트 개요, 아키텍처, 기술 스택 |
| `WBS.md` | 단계(Phase), 마일스톤, 산출물 |
| `pom.xml` | 프로젝트명, 설명, groupId, artifactId (Java) |
| `build.gradle` | 프로젝트명, 버전, group (Java) |

**기술적 동작**:
```
클라이언트 (AnalyzePage.tsx)
    │
    ├─── analyzeApi.getDrives()
    │         │
    │         ▼
    │    GET /api/analyze/drives → 드라이브 목록
    │
    ├─── analyzeApi.browse(path)
    │         │
    │         ▼
    │    GET /api/analyze/browse → 폴더 내용
    │
    ├─── analyzeApi.analyzeFolder(folderPath)
    │         │
    │         ▼
    │    POST /api/analyze/folder
    │         │
    │         ▼
    │    projectAnalyzer.analyzeProjectFolder()
    │         │
    │         ├── collectProjectFiles() : 분석 대상 파일 수집
    │         ├── parsePackageJson()    : package.json 파싱
    │         ├── parseReadme()         : README.md 파싱
    │         ├── parsePrd()            : PRD.md 파싱
    │         ├── parseClaudeMd()       : CLAUDE.md 파싱
    │         ├── parseWbs()            : WBS.md 파싱
    │         ├── detectProjectType()   : 프로젝트 타입 감지
    │         └── extractRequirements() : 요구사항 추출
    │         │
    │         ▼
    │    { success: true, projectInfo: AnalyzedProjectInfo }
    │
    ▼
분석 결과 화면 표시 → 사용자 검토/수정 → 저장
```

---

### 3.5 Step 3: 템플릿 등록

**URL**: `http://localhost:5173/templates`

**절차**:
1. 사이드바에서 "템플릿" 메뉴 클릭
2. "템플릿 업로드" 버튼 클릭
3. 파일 선택 (DOCX 또는 PPTX만 지원)
4. 문서 유형 선택 (요구사항정의서, 수행계획서 등)
5. "업로드" 버튼 클릭

**템플릿 파일 요구사항**:
- 형식: `.docx` 또는 `.pptx`
- 최대 크기: 10MB
- 플레이스홀더 형식: `{{플레이스홀더명}}`

**지원되는 플레이스홀더**:
| 플레이스홀더 | 대체되는 값 |
|-------------|-----------|
| `{{프로젝트명}}` | project.name |
| `{{고객사}}` | project.client |
| `{{설명}}` | project.description |
| `{{범위}}` | project.scope |
| `{{시작일}}` | project.startDate |
| `{{종료일}}` | project.endDate |
| `{{상태}}` | project.status |
| `{{팀원수}}` | project.team.length |
| `{{마일스톤수}}` | project.milestones.length |
| `{{팀원목록}}` | 팀원 정보 리스트 |
| `{{마일스톤목록}}` | 마일스톤 정보 리스트 |

**기술적 동작**:
```
클라이언트 (TemplatesPage.tsx)
    │
    ├─── templateApi.upload(file, documentType)
    │         │
    │         ▼
    │    POST /api/templates/upload (multipart/form-data)
    │         │
    │         ▼
    │    multer: 파일을 templates/uploads/에 저장
    │         │
    │         ▼
    │    templateParser.extractPlaceholders()
    │         │  ※ JSZip으로 파일 압축 해제하여 XML 파싱
    │         │
    │         ▼
    │    dataStore.createTemplate()
    │         │
    │         ▼
    │    store.json에 템플릿 메타데이터 저장
    │
    ▼
템플릿 목록에 새 템플릿 표시
```

---

### 3.6 Step 4: 문서 생성

**URL**: `http://localhost:5173/generate/:projectId`

**절차**:
1. 프로젝트 목록에서 프로젝트 선택 → "문서 생성" 버튼 클릭
2. 생성할 템플릿 선택 (복수 선택 가능)
3. 출력 형식 선택 (DOCX/PPTX/PDF)
4. 저장 방식 선택:
   - **다운로드**: 브라우저에서 직접 다운로드
   - **폴더 저장**: 지정한 폴더에 저장
5. "문서 생성" 버튼 클릭
6. 생성 완료

**기술적 동작**:
```
클라이언트 (GeneratePage.tsx)
    │
    ├─── 다운로드 모드:
    │        │
    │        ├─── documentApi.generate(projectId, templateId, format)
    │        │         │
    │        │         ▼
    │        │    POST /api/documents/generate
    │        │         │
    │        │         ▼
    │        │    Buffer 응답 → Blob → URL.createObjectURL()
    │        │         │
    │        │         ▼
    │        │    <a> 태그로 다운로드 트리거
    │
    ├─── 폴더 저장 모드:
    │        │
    │        ├─── documentApi.generateAndSave(projectId, templateId, savePath, format)
    │        │         │
    │        │         ▼
    │        │    POST /api/documents/generate-and-save
    │        │         │
    │        │         ▼
    │        │    파일 생성 → fs.writeFile(savePath/filename)
    │        │         │
    │        │         ▼
    │        │    { success: true, filePath, filename }
```

---

## 4. 프로젝트 폴더 자동 분석

### 4.1 분석 프로세스 상세

```
┌─────────────────────────────────────────────────────────────────┐
│                  프로젝트 폴더 분석 프로세스                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. 폴더 경로 검증                                               │
│     fs.stat(folderPath) → isDirectory() 확인                    │
│                                                                  │
│  2. 분석 대상 파일 수집                                          │
│     ├── README.md, README.txt                                   │
│     ├── package.json                                            │
│     ├── pom.xml, build.gradle                                   │
│     ├── PRD.md, docs/PRD.md                                     │
│     ├── CLAUDE.md, .claude/CLAUDE.md                            │
│     └── WBS.md, docs/WBS.md                                     │
│                                                                  │
│  3. 디렉토리 구조 분석 (depth=2)                                 │
│     ※ node_modules, .git, dist 등 제외                         │
│                                                                  │
│  4. 각 파일 파싱                                                 │
│     ├── parsePackageJson()  : name, description, author 등      │
│     ├── parseReadme()       : title, description, features      │
│     ├── parsePrd()          : objectives, features, scope       │
│     ├── parseClaudeMd()     : overview, architecture, techStack │
│     ├── parseWbs()          : phases, milestones, deliverables  │
│     └── parsePomXml/Gradle(): Java 프로젝트 메타데이터          │
│                                                                  │
│  5. 프로젝트 타입 감지                                           │
│     ├── React, Vue, Angular, Svelte                             │
│     ├── Next.js, Nuxt.js, Express, NestJS                       │
│     ├── Java (Maven/Gradle)                                     │
│     └── Python (Django/Flask/FastAPI), Go, Rust                 │
│                                                                  │
│  6. 정보 통합 및 우선순위 적용                                   │
│     ├── 이름: PRD > package.json > README > 폴더명              │
│     ├── 설명: PRD > CLAUDE.md > README > package.json           │
│     └── 범위: PRD scope + 아키텍처 + 기술스택                   │
│                                                                  │
│  7. 요구사항/마일스톤 추출                                       │
│     ├── extractRequirementsWithPrd()                            │
│     ├── extractMilestonesFromWbs()                              │
│     └── extractTeam()                                           │
│                                                                  │
│  8. 신뢰도 계산                                                  │
│     ├── 3개 이상 파일 분석 → 0.8 (80%)                          │
│     ├── 2개 파일 분석 → 0.6 (60%)                               │
│     └── 1개 파일 분석 → 0.4 (40%)                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 지원 프로젝트 타입

| 카테고리 | 프로젝트 타입 | 감지 기준 |
|---------|--------------|----------|
| JavaScript | React | package.json에 "react" 의존성 |
| JavaScript | Vue.js | package.json에 "vue" 의존성 |
| JavaScript | Angular | package.json에 "@angular/core" 의존성 |
| JavaScript | Svelte | package.json에 "svelte" 의존성 |
| JavaScript | Next.js | next.config 파일 존재 |
| JavaScript | Nuxt.js | nuxt.config 파일 존재 |
| JavaScript | Node.js | package.json 존재 (기본) |
| JavaScript | Express.js | package.json에 "express" 의존성 |
| JavaScript | NestJS | package.json에 "@nestjs/core" 의존성 |
| Java | Maven | pom.xml 존재 |
| Java | Gradle | build.gradle 또는 build.gradle.kts 존재 |
| Python | Django | manage.py 존재 |
| Python | Flask | flask 관련 파일 존재 |
| Python | FastAPI | fastapi 관련 파일 존재 |
| Go | Go | go.mod 또는 .go 파일 존재 |
| Rust | Rust | Cargo.toml 또는 .rs 파일 존재 |

### 4.3 분석 결과 데이터 구조

```typescript
interface AnalyzedProjectInfo {
  name: string              // 프로젝트명
  client: string            // 고객사 (groupId 등에서 추출)
  description: string       // 설명
  scope: string             // 범위 (타입, 버전, 아키텍처 포함)
  startDate: string         // 시작일 (빈 값, 사용자 입력 필요)
  endDate: string           // 종료일 (빈 값, 사용자 입력 필요)
  status: string            // 상태 (기본: "진행중")
  team: TeamMember[]        // 팀 구성 (author/contributors에서 추출)
  milestones: Milestone[]   // 마일스톤 (WBS에서 추출)
  requirements: {           // 요구사항
    functional: Requirement[]
    nonFunctional: Requirement[]
  }
  analyzedFiles: string[]   // 분석된 파일 목록
  confidence: number        // 분석 신뢰도 (0.0 ~ 1.0)
}
```

---

## 5. 템플릿별 자동 생성 프로세스

### 5.1 DOCX (Word) 생성 프로세스

**파일**: `server/src/generators/docx/generator.ts`

```
┌─────────────────────────────────────────────────────────────────┐
│                    DOCX 생성 프로세스                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. 템플릿 파일 읽기                                             │
│     fs.readFile(template.filePath) → Buffer                     │
│                                                                  │
│  2. JSZip으로 압축 해제                                          │
│     JSZip.loadAsync(fileBuffer) → zip 객체                      │
│                                                                  │
│  3. XML 파일 처리 (순서대로)                                     │
│     ├── word/document.xml     (본문)                            │
│     ├── word/header#.xml      (머리글)                          │
│     └── word/footer#.xml      (바닥글)                          │
│                                                                  │
│  4. 각 XML에 대해:                                               │
│     ├── preprocessXml(): 분할된 플레이스홀더 병합               │
│     │   ※ Word가 {{프로젝트명}}을 <w:t>{{</w:t><w:t>프로젝트    │
│     │     </w:t><w:t>명}}</w:t>처럼 분할하는 문제 해결           │
│     │                                                            │
│     └── replacePlaceholders():                                  │
│         정규식으로 {{key}} 찾아서 project 데이터로 치환          │
│                                                                  │
│  5. 수정된 XML을 zip에 다시 저장                                 │
│     zip.file(path, processedXml)                                │
│                                                                  │
│  6. 새 DOCX 파일 생성                                            │
│     zip.generateAsync({ type: 'nodebuffer' }) → Buffer          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**preprocessXml 상세**:
```
문제 상황:
  Word에서 {{프로젝트명}}을 입력하면 내부적으로 다음처럼 분할됨:
  <w:r><w:t>{{</w:t></w:r><w:r><w:t>프로젝트</w:t></w:r><w:r><w:t>명}}</w:t></w:r>

해결 방법:
  1. <w:r>...</w:r> (run) 단위로 파싱
  2. run 내의 모든 <w:t>...</w:t> 텍스트를 연결
  3. 연결된 텍스트에 {{...}} 패턴이 있으면
  4. 하나의 <w:t>로 병합하여 치환 가능하게 만듦
```

---

### 5.2 PPTX (PowerPoint) 생성 프로세스

**파일**: `server/src/generators/pptx/generator.ts`

```
┌─────────────────────────────────────────────────────────────────┐
│                    PPTX 생성 프로세스                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. 템플릿 파일 읽기                                             │
│     fs.readFile(template.filePath) → Buffer                     │
│                                                                  │
│  2. JSZip으로 압축 해제                                          │
│     JSZip.loadAsync(fileBuffer) → zip 객체                      │
│                                                                  │
│  3. XML 파일 처리 (순서대로)                                     │
│     ├── ppt/slides/slide#.xml       (슬라이드)                  │
│     ├── ppt/slideLayouts/slideLayout#.xml (레이아웃)            │
│     └── ppt/slideMasters/slideMaster#.xml (마스터)              │
│                                                                  │
│  4. 각 XML에 대해:                                               │
│     ├── preprocessXml(): 분할된 플레이스홀더 병합               │
│     │   ※ PowerPoint도 <a:t>태그로 텍스트 분할                  │
│     │                                                            │
│     └── replacePlaceholders():                                  │
│         정규식으로 {{key}} 찾아서 project 데이터로 치환          │
│                                                                  │
│  5. 수정된 XML을 zip에 다시 저장                                 │
│                                                                  │
│  6. 새 PPTX 파일 생성                                            │
│     zip.generateAsync({ type: 'nodebuffer' }) → Buffer          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**DOCX vs PPTX 차이점**:
| 항목 | DOCX | PPTX |
|------|------|------|
| 텍스트 태그 | `<w:t>` | `<a:t>` |
| 런(Run) 태그 | `<w:r>` | `<a:r>` |
| 메인 콘텐츠 | `word/document.xml` | `ppt/slides/slide#.xml` |
| 부가 요소 | header, footer | slideLayouts, slideMasters |

---

### 5.3 PDF 생성 프로세스

**파일**: `server/src/generators/pdf/generator.ts`

```
┌─────────────────────────────────────────────────────────────────┐
│                     PDF 생성 프로세스                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ⚠️ 템플릿 파일을 사용하지 않음! (프로젝트 데이터만 사용)        │
│                                                                  │
│  1. PDFDocument 생성 (PDFKit 라이브러리)                        │
│     new PDFDocument({ size: 'A4', margin: 50 })                 │
│                                                                  │
│  2. 폰트 설정                                                    │
│     ├── Helvetica (기본, 영문 전용)                             │
│     └── ※ 한국어 지원을 위해 별도 폰트 필요                     │
│                                                                  │
│  3. 페이지 구성 (하드코딩된 레이아웃)                            │
│     ├── 헤더 (DocuGen 로고, 타이틀)                              │
│     ├── 문서 제목 (template.documentType)                       │
│     ├── 프로젝트명                                               │
│     ├── 프로젝트 정보 섹션                                       │
│     │   (이름, 고객사, 시작일, 종료일, 상태)                    │
│     ├── 프로젝트 설명 섹션                                       │
│     ├── 프로젝트 범위 섹션                                       │
│     ├── 팀 구성 섹션 (있는 경우)                                 │
│     ├── 마일스톤 섹션 (있는 경우)                                │
│     ├── 요구사항 섹션 (있는 경우)                                │
│     └── 푸터 (페이지 번호)                                       │
│                                                                  │
│  4. Buffer로 변환하여 반환                                       │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**PDF 생성의 한계점**:
- ❌ 템플릿 파일의 디자인을 무시함
- ❌ 레이아웃이 하드코딩되어 있음
- ⚠️ 한국어 폰트 미설치 시 한글 깨짐
- 💡 권장: DOCX로 생성 후 PDF로 변환

---

## 6. 기술적 상세 프로세스

### 6.1 API 엔드포인트 목록

| Method | Endpoint | Description |
|--------|----------|-------------|
| **프로젝트** | | |
| GET | /api/projects | 모든 프로젝트 조회 |
| GET | /api/projects/:id | 프로젝트 상세 조회 |
| POST | /api/projects | 프로젝트 생성 |
| PUT | /api/projects/:id | 프로젝트 수정 |
| DELETE | /api/projects/:id | 프로젝트 삭제 |
| **템플릿** | | |
| GET | /api/templates | 모든 템플릿 조회 |
| POST | /api/templates/upload | 템플릿 업로드 (multipart) |
| DELETE | /api/templates/:id | 템플릿 삭제 |
| **문서** | | |
| POST | /api/documents/generate | 문서 생성 (다운로드) |
| POST | /api/documents/generate-pdf | PDF 생성 |
| POST | /api/documents/generate-and-save | 문서 생성 후 저장 |
| **분석** | | |
| GET | /api/analyze/drives | 드라이브 목록 조회 |
| GET | /api/analyze/browse | 디렉토리 탐색 |
| POST | /api/analyze/folder | 프로젝트 폴더 분석 |
| **시스템** | | |
| GET | /api/health | 서버 상태 확인 |

### 6.2 플레이스홀더 치환 로직

```javascript
function getPlaceholderValue(key: string, project: Project): string {
  const keyMap = {
    '프로젝트명': project.name,
    '고객사': project.client,
    '설명': project.description,
    '범위': project.scope,
    '시작일': project.startDate,
    '종료일': project.endDate,
    '상태': project.status,
    '팀원수': String(project.team.length),
    '마일스톤수': String(project.milestones.length),
  }

  // 팀원목록 특별 처리
  if (key === '팀원목록') {
    return project.team
      .map(m => `${m.name} (${m.role}): ${m.responsibility}`)
      .join('\n')
  }

  // 마일스톤목록 특별 처리
  if (key === '마일스톤목록') {
    return project.milestones
      .map(m => `${m.name} - ${m.date}: ${m.deliverables}`)
      .join('\n')
  }

  // 매핑에 없으면 원본 유지
  return keyMap[key] ?? `{{${key}}}`
}
```

---

## 7. 문제 진단 체크리스트

### 7.1 서버 실행 문제

| 증상 | 원인 | 해결방법 |
|------|------|----------|
| `MODULE_NOT_FOUND` | 의존성 미설치 | `npm run install:all` 실행 |
| Port 4000 already in use | 포트 충돌 | 기존 프로세스 종료 후 재시작 |
| TypeScript 에러 | 타입 불일치 | `cd server && npm run build` 확인 |

### 7.2 클라이언트 실행 문제

| 증상 | 원인 | 해결방법 |
|------|------|----------|
| 빈 화면 | 서버 미실행 | `npm run dev:server` 확인 |
| API 오류 | CORS 또는 라우팅 | 서버 콘솔 로그 확인 |
| 로그인 실패 | 잘못된 자격 증명 | `admin` / `admin123` 확인 |

### 7.3 프로젝트 분석 문제

| 증상 | 원인 | 해결방법 |
|------|------|----------|
| 분석 가능 파일 없음 | README, package.json 없음 | 분석 대상 파일 추가 |
| 낮은 신뢰도 | 파일 수 부족 | PRD.md, WBS.md 등 추가 |
| 프로젝트 타입 미인식 | 구조가 표준이 아님 | package.json 또는 설정 파일 확인 |

### 7.4 문서 생성 문제

| 증상 | 원인 | 해결방법 |
|------|------|----------|
| 플레이스홀더 미치환 | XML 분할 문제 | preprocessXml 로직 확인 |
| 한글 깨짐 (PDF) | 폰트 미설치 | `assets/fonts/`에 한글 폰트 추가 |
| 빈 문서 생성 | 템플릿 파일 손상 | 템플릿 재업로드 |
| 프로젝트/템플릿 없음 | store.json 동기화 | 데이터 재등록 |

### 7.5 템플릿 문제

| 증상 | 원인 | 해결방법 |
|------|------|----------|
| 업로드 실패 | 파일 형식 오류 | .docx 또는 .pptx만 지원 |
| 플레이스홀더 미인식 | 형식 불일치 | `{{키}}` 형식 확인 |
| 부분 치환 | 텍스트 분할 | 한 번에 입력 (복사/붙여넣기 금지) |

---

## 부록: 개발/운영 명령어

```bash
# 전체 의존성 설치
npm run install:all

# 개발 서버 실행 (클라이언트 + 서버 동시)
npm run dev

# 클라이언트만 실행 (포트 5173)
npm run dev:client

# 서버만 실행 (포트 4000)
npm run dev:server

# 프로덕션 빌드
npm run build
```

---

*문서 작성일: 2024.12.21*
*DocuGen v2.0.0 - 프로젝트 분석 기능 추가*
