# DocuGen (다큐젠) 운영자 매뉴얼

## 목차
1. [시스템 개요](#1-시스템-개요)
2. [시스템 아키텍처](#2-시스템-아키텍처)
3. [설치 및 배포](#3-설치-및-배포)
4. [서버 운영](#4-서버-운영)
5. [데이터 관리](#5-데이터-관리)
6. [API 명세](#6-api-명세)
7. [문제 해결](#7-문제-해결)
8. [보안 관리](#8-보안-관리)
9. [백업 및 복구](#9-백업-및-복구)

---

## 1. 시스템 개요

### 1.1 시스템 정보
- **시스템명**: DocuGen (다큐젠)
- **버전**: 1.0.0
- **목적**: SI 프로젝트 문서 자동 생성
- **개발사**: Dongkuk Systems

### 1.2 기술 스택

| 구분 | 기술 |
|------|------|
| Frontend | React 18 + Vite + TypeScript + Tailwind CSS |
| Backend | Express.js + TypeScript |
| 문서 생성 | JSZip (DOCX/PPTX), PDFKit (PDF) |
| 데이터 저장 | JSON 파일 기반 |

### 1.3 시스템 구성 요소
```
DocuGen/
├── client/          # React 프론트엔드
├── server/          # Express 백엔드
├── templates/       # 템플릿 저장소
├── data/           # 데이터 저장소
└── docs/           # 문서
```

---

## 2. 시스템 아키텍처

### 2.1 전체 아키텍처
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   Client    │────▶│   Server    │────▶│  DataStore  │
│  (React)    │◀────│  (Express)  │◀────│   (JSON)    │
└─────────────┘     └─────────────┘     └─────────────┘
     Port 5173          Port 4000         store.json
```

### 2.2 데이터 흐름
```
사용자 요청 → React Router → API 호출 → Express Route
    → Service Layer → DataStore → JSON 파일
```

### 2.3 주요 디렉토리 구조

#### 서버 (server/src/)
```
server/src/
├── index.ts              # Express 앱 진입점
├── routes/
│   ├── projects.ts       # 프로젝트 CRUD API
│   ├── templates.ts      # 템플릿 업로드/관리 API
│   └── documents.ts      # 문서 생성 API
├── services/
│   ├── dataStore.ts      # JSON 파일 기반 데이터 저장
│   └── templateParser.ts # 템플릿 플레이스홀더 파싱
└── generators/
    ├── docx/generator.ts # DOCX 생성기
    ├── pptx/generator.ts # PPTX 생성기
    └── pdf/generator.ts  # PDF 생성기
```

#### 클라이언트 (client/src/)
```
client/src/
├── App.tsx               # 라우터 및 인증 설정
├── contexts/
│   └── AuthContext.tsx   # 인증 상태 관리
├── pages/
│   ├── LoginPage.tsx     # 로그인 페이지
│   ├── HomePage.tsx      # 문서 생성 메인
│   ├── ProjectsPage.tsx  # 프로젝트 목록
│   ├── ProjectFormPage.tsx # 프로젝트 등록/수정
│   ├── TemplatesPage.tsx # 템플릿 관리
│   └── GeneratePage.tsx  # 문서 생성
├── components/
│   └── Layout.tsx        # 공통 레이아웃
├── services/
│   └── api.ts            # API 클라이언트
└── types/
    └── index.ts          # TypeScript 타입 정의
```

---

## 3. 설치 및 배포

### 3.1 사전 요구사항
- Node.js 18.x 이상
- npm 9.x 이상
- Git

### 3.2 설치 절차

#### Step 1: 소스 코드 클론
```bash
git clone <repository-url>
cd Prj_doc_creator
```

#### Step 2: 의존성 설치
```bash
# 모든 의존성 설치 (root, client, server)
npm run install:all
```

#### Step 3: 개발 서버 실행
```bash
# 클라이언트와 서버 동시 실행
npm run dev
```

### 3.3 개별 서버 실행

#### 클라이언트만 실행 (Port 5173)
```bash
npm run dev:client
```

#### 서버만 실행 (Port 4000)
```bash
npm run dev:server
```

### 3.4 프로덕션 빌드
```bash
# 프로덕션 빌드
npm run build
```

### 3.5 환경 설정

#### 서버 환경 변수
| 변수명 | 기본값 | 설명 |
|--------|--------|------|
| PORT | 4000 | 서버 포트 |
| NODE_ENV | development | 실행 환경 |

#### 클라이언트 환경 변수
| 변수명 | 기본값 | 설명 |
|--------|--------|------|
| VITE_API_URL | http://localhost:4000/api | API 서버 URL |

---

## 4. 서버 운영

### 4.1 서버 상태 확인
```bash
# Health Check 엔드포인트
curl http://localhost:4000/api/health
```

응답 예시:
```json
{
  "status": "ok",
  "timestamp": "2026-01-01T00:00:00.000Z"
}
```

### 4.2 포트 사용 현황
| 서비스 | 포트 | 설명 |
|--------|------|------|
| Frontend (Vite) | 5173 | 개발 서버 |
| Frontend (Production) | 3000 | 프로덕션 서버 |
| Backend (Express) | 4000 | API 서버 |

### 4.3 프로세스 관리 (PM2 사용 시)
```bash
# PM2로 서버 실행
pm2 start server/dist/index.js --name docugen-api

# 상태 확인
pm2 status

# 로그 확인
pm2 logs docugen-api

# 재시작
pm2 restart docugen-api

# 중지
pm2 stop docugen-api
```

### 4.4 로그 관리
- **위치**: 콘솔 출력 (개발 환경)
- **형식**: Express 기본 로깅

로그 예시:
```
Server is running on port 4000
POST /api/projects 201 15ms
GET /api/templates 200 5ms
POST /api/documents/generate 200 250ms
```

---

## 5. 데이터 관리

### 5.1 데이터 저장 구조
데이터는 `data/store.json` 파일에 JSON 형식으로 저장됩니다.

```json
{
  "projects": [
    {
      "id": "uuid",
      "name": "프로젝트명",
      "client": "고객사",
      "description": "설명",
      "scope": "범위",
      "startDate": "2026-01-01",
      "endDate": "2026-12-31",
      "status": "진행중",
      "team": [],
      "milestones": [],
      "requirements": {
        "functional": [],
        "nonFunctional": []
      },
      "createdAt": "timestamp",
      "updatedAt": "timestamp"
    }
  ],
  "templates": [
    {
      "id": "uuid",
      "name": "템플릿명",
      "documentType": "문서유형",
      "format": "docx",
      "filePath": "templates/uploads/file.docx",
      "placeholders": ["{{프로젝트명}}", "{{고객사}}"],
      "createdAt": "timestamp"
    }
  ]
}
```

### 5.2 템플릿 파일 저장
- **위치**: `templates/uploads/`
- **지원 형식**: DOCX, PPTX
- **명명 규칙**: `{uuid}_{originalFilename}`

### 5.3 데이터 초기화
데이터를 초기화하려면 다음 파일을 삭제합니다:
```bash
rm data/store.json
rm -rf templates/uploads/*
```

서버 재시작 시 빈 store.json이 자동 생성됩니다.

---

## 6. API 명세

### 6.1 프로젝트 API

#### 프로젝트 목록 조회
```
GET /api/projects
Response: Project[]
```

#### 프로젝트 상세 조회
```
GET /api/projects/:id
Response: Project
```

#### 프로젝트 생성
```
POST /api/projects
Body: Project (without id)
Response: Project
```

#### 프로젝트 수정
```
PUT /api/projects/:id
Body: Partial<Project>
Response: Project
```

#### 프로젝트 삭제
```
DELETE /api/projects/:id
Response: { success: true }
```

### 6.2 템플릿 API

#### 템플릿 목록 조회
```
GET /api/templates
Response: Template[]
```

#### 템플릿 업로드
```
POST /api/templates/upload
Content-Type: multipart/form-data
Body: file, name, documentType
Response: Template
```

#### 템플릿 삭제
```
DELETE /api/templates/:id
Response: { success: true }
```

### 6.3 문서 생성 API

#### DOCX/PPTX 문서 생성
```
POST /api/documents/generate
Body: {
  projectId: string,
  templateId: string,
  format: 'docx' | 'pptx'
}
Response: Binary file (application/octet-stream)
```

#### PDF 문서 생성
```
POST /api/documents/generate-pdf
Body: {
  projectId: string,
  templateId: string
}
Response: Binary file (application/pdf)
```

### 6.4 상태 확인 API
```
GET /api/health
Response: { status: 'ok', timestamp: string }
```

---

## 7. 문제 해결

### 7.1 일반적인 오류

#### 서버 시작 실패
**증상**: `EADDRINUSE` 오류
```
Error: listen EADDRINUSE: address already in use :::4000
```
**해결**:
```bash
# 포트 사용 프로세스 확인 및 종료
netstat -ano | findstr :4000
taskkill /PID <PID> /F
```

#### 파일 업로드 실패
**증상**: 413 Payload Too Large
**해결**: Express 파일 크기 제한 확인 (기본 10MB)

#### CORS 오류
**증상**: 브라우저 콘솔에 CORS 에러
**해결**: 서버의 CORS 설정 확인
```typescript
// server/src/index.ts
app.use(cors({
  origin: 'http://localhost:5173'
}))
```

### 7.2 문서 생성 오류

#### PDF 한글 깨짐
**원인**: PDFKit 기본 폰트가 한글 미지원
**해결**: 한글 폰트 설치 또는 DOCX로 생성 후 변환 권장

#### 템플릿 플레이스홀더 미치환
**원인**: 템플릿 파일 형식 오류 또는 XML 구조 문제
**해결**:
1. 템플릿 파일 다시 생성
2. 단순한 텍스트로 플레이스홀더 입력
3. 특수 서식 제거

### 7.3 성능 문제

#### 대용량 파일 처리 지연
**해결**:
- 파일 크기 제한 설정
- 비동기 처리 적용
- 메모리 사용량 모니터링

---

## 8. 보안 관리

### 8.1 인증 시스템
- **방식**: 클라이언트 사이드 인증 (sessionStorage)
- **기본 계정**: admin / admin123

> **주의**: 현재 버전은 데모용으로, 프로덕션 환경에서는 서버 사이드 인증 및 JWT 토큰 방식 구현 필요

### 8.2 보안 권고사항

#### 즉시 적용 필요
1. 기본 비밀번호 변경
2. HTTPS 적용
3. 파일 업로드 유효성 검증 강화

#### 프로덕션 배포 시
1. 서버 사이드 인증 구현
2. API Rate Limiting 적용
3. 입력값 검증 강화
4. SQL Injection, XSS 방지
5. 보안 헤더 설정 (Helmet.js)

### 8.3 파일 업로드 보안
- 허용 확장자: `.docx`, `.pptx`
- 파일 크기 제한: 10MB
- 파일명 새니타이징: UUID 기반 저장

---

## 9. 백업 및 복구

### 9.1 백업 대상
| 대상 | 위치 | 설명 |
|------|------|------|
| 데이터 | `data/store.json` | 프로젝트/템플릿 메타데이터 |
| 템플릿 | `templates/uploads/` | 업로드된 템플릿 파일 |

### 9.2 백업 절차

#### 수동 백업
```bash
# 백업 디렉토리 생성
mkdir -p backup/$(date +%Y%m%d)

# 데이터 백업
cp data/store.json backup/$(date +%Y%m%d)/

# 템플릿 백업
cp -r templates/uploads backup/$(date +%Y%m%d)/
```

#### 자동 백업 스크립트
```bash
#!/bin/bash
# backup.sh
BACKUP_DIR="backup/$(date +%Y%m%d_%H%M%S)"
mkdir -p $BACKUP_DIR
cp data/store.json $BACKUP_DIR/
cp -r templates/uploads $BACKUP_DIR/
echo "Backup completed: $BACKUP_DIR"
```

### 9.3 복구 절차
```bash
# 특정 날짜 백업에서 복구
cp backup/20260101/store.json data/
cp -r backup/20260101/uploads/* templates/uploads/

# 서버 재시작
npm run dev:server
```

### 9.4 백업 주기 권고
| 환경 | 주기 | 보관 기간 |
|------|------|-----------|
| 개발 | 수동 | 1주 |
| 스테이징 | 일 1회 | 1개월 |
| 프로덕션 | 일 2회 | 3개월 |

---

## 부록 A: 명령어 요약

| 명령어 | 설명 |
|--------|------|
| `npm run install:all` | 전체 의존성 설치 |
| `npm run dev` | 개발 서버 실행 (Client + Server) |
| `npm run dev:client` | 클라이언트만 실행 |
| `npm run dev:server` | 서버만 실행 |
| `npm run build` | 프로덕션 빌드 |
| `npm run lint` | 코드 린트 검사 |

---

## 부록 B: 타입 정의

### Project 타입
```typescript
interface Project {
  id: string
  name: string
  client: string
  description: string
  scope: string
  startDate: string
  endDate: string
  status: string
  team: TeamMember[]
  milestones: Milestone[]
  requirements: {
    functional: string[]
    nonFunctional: string[]
  }
  createdAt: string
  updatedAt: string
}
```

### Template 타입
```typescript
interface Template {
  id: string
  name: string
  documentType: string
  format: 'docx' | 'pptx'
  filePath: string
  placeholders: string[]
  createdAt: string
}
```

---

## 문의 및 지원

- **개발사**: Dongkuk Systems
- **버전**: 1.0.0
- **최종 업데이트**: 2026년

© 2026 Dongkuk Systems. All rights reserved.
