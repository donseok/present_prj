# DocuGen 트러블슈팅 가이드

프로그램이 정상 작동하지 않을 때 참고하는 문제 해결 가이드입니다.

---

## 빠른 진단 체크리스트

아래 순서대로 확인해 주세요:

- [ ] **1단계**: 의존성 설치 완료? → `npm run install:all`
- [ ] **2단계**: 서버 실행 중? → `npm run dev:server` (포트 4000)
- [ ] **3단계**: 클라이언트 실행 중? → `npm run dev:client` (포트 5173)
- [ ] **4단계**: 브라우저에서 접속 가능? → `http://localhost:5173`
- [ ] **5단계**: 로그인 성공? → `admin` / `admin123`
- [ ] **6단계**: 프로젝트 등록됨? → 프로젝트 메뉴 확인
- [ ] **7단계**: 템플릿 등록됨? → 템플릿 메뉴 확인

---

## 목차

1. [서버 실행 오류](#1-서버-실행-오류)
2. [클라이언트 실행 오류](#2-클라이언트-실행-오류)
3. [로그인 문제](#3-로그인-문제)
4. [프로젝트 관리 문제](#4-프로젝트-관리-문제)
5. [프로젝트 폴더 분석 문제](#5-프로젝트-폴더-분석-문제)
6. [템플릿 관리 문제](#6-템플릿-관리-문제)
7. [문서 생성 문제](#7-문서-생성-문제)
8. [데이터 관련 문제](#8-데이터-관련-문제)
9. [성능 문제](#9-성능-문제)
10. [개발자 진단 도구](#10-개발자-진단-도구)

---

## 1. 서버 실행 오류

### 1.1 `MODULE_NOT_FOUND` 에러

**증상**:
```
Error: Cannot find module 'express'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1048:15)
```

**원인**: 의존성이 설치되지 않음

**해결**:
```bash
# 프로젝트 루트에서 실행
npm run install:all

# 또는 개별 폴더에서
cd server && npm install
cd client && npm install
```

---

### 1.2 `Port 4000 already in use`

**증상**:
```
Error: listen EADDRINUSE: address already in use :::4000
```

**원인**: 이미 다른 프로세스가 4000 포트를 사용 중

**해결** (Windows):
```powershell
# 4000 포트 사용 프로세스 찾기
netstat -ano | findstr :4000

# 해당 PID 종료
taskkill /PID <PID번호> /F
```

**해결** (Mac/Linux):
```bash
# 4000 포트 사용 프로세스 종료
lsof -ti:4000 | xargs kill -9
```

---

### 1.3 TypeScript 컴파일 에러

**증상**:
```
error TS2307: Cannot find module './services/dataStore.js'
```

**원인**: TypeScript 빌드 문제

**해결**:
```bash
cd server
npm run build
```

---

## 2. 클라이언트 실행 오류

### 2.1 빈 화면 / 로딩만 표시

**증상**: 브라우저에서 `http://localhost:5173` 접속 시 빈 화면

**원인**:
1. 서버가 실행되지 않음
2. API 요청 실패

**진단**:
1. 서버 터미널 확인 → 서버 실행 중인지 확인
2. 브라우저 개발자 도구 → Network 탭에서 API 요청 확인
3. Console 탭에서 에러 메시지 확인

**해결**:
```bash
# 서버 먼저 실행
npm run dev:server

# 클라이언트 실행
npm run dev:client
```

---

### 2.2 CORS 에러

**증상**:
```
Access to XMLHttpRequest at 'http://localhost:4000/api/...' has been blocked by CORS policy
```

**원인**: 서버의 CORS 설정 문제

**해결**: `server/src/index.ts` 확인
```typescript
import cors from 'cors'
app.use(cors())  // 이 줄이 있는지 확인
```

---

### 2.3 Vite 빌드 에러

**증상**:
```
[vite] Internal server error: ...
```

**해결**:
```bash
cd client
rm -rf node_modules
npm install
npm run dev
```

---

## 3. 로그인 문제

### 3.1 로그인 실패

**증상**: 올바른 자격증명 입력해도 로그인 안 됨

**확인사항**:
- 기본 계정: `admin` / `admin123`
- 대소문자 구분됨

**진단**: 브라우저 개발자 도구 → Application → Session Storage 확인

**해결**: 세션 스토리지 초기화
```javascript
// 브라우저 콘솔에서 실행
sessionStorage.clear()
```

---

## 4. 프로젝트 관리 문제

### 4.1 프로젝트 저장 실패

**증상**: "저장" 버튼 클릭 후 에러 또는 저장 안 됨

**원인**:
1. 필수 필드 미입력 (프로젝트명)
2. 서버 연결 실패
3. store.json 파일 권한 문제

**진단**:
1. Network 탭에서 `POST /api/projects` 요청 확인
2. 서버 콘솔에서 에러 로그 확인

**해결**:
```bash
# store.json 파일 권한 확인
# Windows
icacls data\store.json

# store.json 파일이 없다면 생성
echo {"projects":[],"templates":[]} > data/store.json
```

---

### 4.2 프로젝트 목록 안 보임

**증상**: 프로젝트 페이지에서 등록한 프로젝트가 안 보임

**진단**:
```bash
# store.json 내용 확인
type data\store.json
```

**해결**: `data/store.json` 파일 형식 확인
```json
{
  "projects": [
    {
      "id": "...",
      "name": "...",
      ...
    }
  ],
  "templates": []
}
```

---

## 5. 프로젝트 폴더 분석 문제

### 5.1 드라이브 목록이 안 보임

**증상**: 분석 페이지에서 드라이브 선택 버튼이 없음

**원인**:
1. 서버 연결 실패
2. `/api/analyze/drives` 엔드포인트 오류

**진단**:
```bash
# API 직접 테스트
curl http://localhost:4000/api/analyze/drives
```

**해결**:
1. 서버 재시작
2. `server/src/routes/analyze.ts` 파일 확인

---

### 5.2 폴더 탐색 안 됨

**증상**: 폴더를 클릭해도 내용이 로드되지 않음

**원인**:
1. 권한 문제 (접근 불가 폴더)
2. 경로 인코딩 문제

**진단**:
```bash
# API 직접 테스트
curl "http://localhost:4000/api/analyze/browse?path=C:\Users"
```

**해결**:
1. 접근 가능한 폴더로 이동
2. 경로에 특수문자가 있는 경우 수동 입력

---

### 5.3 분석 가능한 파일 없음 에러

**증상**: "분석 시작" 클릭 후 "분석할 수 있는 파일을 찾을 수 없습니다" 에러

**원인**: 분석 대상 파일이 폴더에 없음

**분석 대상 파일**:
- README.md
- package.json
- pom.xml
- build.gradle
- PRD.md
- CLAUDE.md
- WBS.md

**해결**:
1. 프로젝트 폴더에 README.md 또는 package.json 추가
2. 올바른 프로젝트 폴더인지 확인

---

### 5.4 낮은 신뢰도로 분석됨

**증상**: 분석 결과 신뢰도가 40~60%로 낮게 표시됨

**원인**: 분석된 파일 수가 적음

**신뢰도 기준**:
| 분석된 파일 수 | 신뢰도 |
|--------------|--------|
| 3개 이상 | 80% |
| 2개 | 60% |
| 1개 | 40% |

**해결**:
1. 프로젝트에 PRD.md, WBS.md, CLAUDE.md 등 추가
2. package.json에 description, author 등 정보 추가

---

### 5.5 프로젝트 타입이 "알 수 없음"으로 표시

**증상**: 분석 결과에서 프로젝트 타입을 인식하지 못함

**원인**:
1. package.json이 없음
2. 의존성 정보가 없음

**해결**:
1. package.json 파일 추가
2. dependencies 또는 devDependencies에 프레임워크 추가

**지원 프로젝트 타입**:
```
React, Vue.js, Angular, Svelte
Next.js, Nuxt.js, Express.js, NestJS
Java (Maven/Gradle)
Python (Django/Flask/FastAPI)
Go, Rust
```

---

### 5.6 분석 결과가 부정확함

**증상**: 추출된 프로젝트 정보가 실제와 다름

**원인**:
1. 파일 형식이 표준과 다름
2. 정규식 패턴 매칭 실패

**해결**:
1. README.md 첫 줄에 `# 프로젝트명` 형식 사용
2. package.json의 name, description 필드 작성
3. 분석 후 검토 화면에서 수동 수정

---

## 6. 템플릿 관리 문제

### 6.1 템플릿 업로드 실패

**증상**: 파일 선택 후 업로드 에러

**원인**:
1. 지원하지 않는 파일 형식 (.doc, .ppt 등)
2. 파일 크기 초과 (10MB 이상)
3. templates/uploads 디렉토리 없음

**해결**:
```bash
# 디렉토리 생성
mkdir -p templates/uploads

# 지원 형식 확인: .docx 또는 .pptx만 가능
```

---

### 6.2 플레이스홀더가 인식되지 않음

**증상**: 업로드 시 플레이스홀더가 0개로 표시됨

**원인**:
1. 플레이스홀더 형식 오류 (예: `{프로젝트명}` → `{{프로젝트명}}`)
2. 텍스트가 XML에서 분할됨

**확인**:
- 올바른 형식: `{{프로젝트명}}`
- 잘못된 형식: `{프로젝트명}`, `{{ 프로젝트명 }}` (공백)

**템플릿 작성 팁**:
1. 플레이스홀더는 한 번에 입력 (복사/붙여넣기 금지)
2. Word/PowerPoint에서 자동 서식 기능 끄기
3. 특수문자 자동변환 기능 비활성화

---

## 7. 문서 생성 문제

### 7.1 문서 생성 실패

**증상**: "문서 생성" 버튼 클릭 시 에러

**진단**:
```bash
# 서버 콘솔 로그 확인
# 다음 에러 메시지 확인:
# - "Project not found"
# - "Template not found"
# - "Failed to generate document"
```

**원인별 해결**:

| 에러 메시지 | 원인 | 해결 |
|------------|------|------|
| Project not found | store.json에 프로젝트 없음 | 프로젝트 재등록 |
| Template not found | store.json에 템플릿 없음 | 템플릿 재업로드 |
| ENOENT | 템플릿 파일이 삭제됨 | 템플릿 재업로드 |
| Save path does not exist | 저장 경로 없음 | 올바른 저장 경로 선택 |

---

### 7.2 플레이스홀더가 치환되지 않음

**증상**: 생성된 문서에 `{{프로젝트명}}`이 그대로 표시됨

**원인**:
1. 플레이스홀더가 XML에서 분할됨
2. 지원하지 않는 플레이스홀더명

**진단**:
템플릿 파일을 zip으로 열어서 XML 확인
```bash
# DOCX 내부 확인
# .docx 파일을 .zip으로 이름 변경 후 압축 해제
# word/document.xml 파일 열어서 플레이스홀더 상태 확인
```

**지원되는 플레이스홀더**:
```
{{프로젝트명}}
{{고객사}}
{{설명}}
{{범위}}
{{시작일}}
{{종료일}}
{{상태}}
{{팀원수}}
{{마일스톤수}}
{{팀원목록}}
{{마일스톤목록}}
```

---

### 7.3 PDF 한글 깨짐

**증상**: PDF 생성 시 한글이 네모(□)로 표시됨

**원인**: 한국어 폰트 미설치

**해결**:
1. 한글 폰트 파일 다운로드 (NotoSansKR-Regular.ttf 등)
2. `server/src/assets/fonts/` 디렉토리에 복사

```bash
mkdir -p server/src/assets/fonts
# NotoSansKR-Regular.ttf 파일을 해당 폴더에 복사
```

**대안**: DOCX로 생성 후 PDF로 변환 (Word 또는 LibreOffice 사용)

---

### 7.4 다운로드가 안 됨

**증상**: 생성 완료 메시지 후 다운로드 창이 안 열림

**원인**:
1. 브라우저 팝업 차단
2. 다운로드 경로 문제

**해결**:
1. 브라우저 팝업 허용 설정
2. 다운로드 폴더 확인
3. 브라우저 개발자 도구 → Network 탭에서 응답 확인

---

### 7.5 폴더 저장 실패

**증상**: "문서 생성 후 저장" 시 에러 발생

**원인**:
1. 저장 경로가 존재하지 않음
2. 쓰기 권한 없음
3. 파일명에 특수문자 포함

**해결**:
```bash
# 저장 경로 확인
dir "저장경로"

# 폴더 생성
mkdir "저장경로"

# 쓰기 권한 확인
icacls "저장경로"
```

---

## 8. 데이터 관련 문제

### 8.1 store.json 손상

**증상**: 서버 시작 시 JSON 파싱 에러

**원인**: store.json 파일이 올바른 JSON 형식이 아님

**해결**:
```bash
# 백업 후 초기화
copy data\store.json data\store.backup.json
echo {"projects":[],"templates":[]} > data\store.json
```

---

### 8.2 템플릿 파일 누락

**증상**: 템플릿 목록에는 있지만 생성 시 에러

**진단**:
```bash
# store.json에서 filePath 확인
type data\store.json

# 해당 파일 존재 확인
dir templates\uploads\
```

**해결**:
1. 해당 템플릿 삭제 후 재업로드
2. 또는 store.json에서 해당 템플릿 항목 수동 삭제

---

## 9. 성능 문제

### 9.1 문서 생성이 느림

**원인**:
1. 템플릿 파일 크기가 큼
2. 많은 이미지 포함
3. 복잡한 서식

**해결**:
1. 템플릿 최적화 (불필요한 요소 제거)
2. 이미지 크기 줄이기
3. 서버 메모리 확인

---

### 9.2 폴더 분석이 느림

**원인**:
1. 대용량 프로젝트 폴더
2. 많은 파일/폴더 포함
3. 네트워크 드라이브

**해결**:
1. 프로젝트 루트 폴더만 선택 (하위 폴더 아님)
2. node_modules 등 대용량 폴더 제외됨 (자동)

---

### 9.3 브라우저 메모리 문제

**증상**: 여러 문서 생성 시 브라우저가 느려짐

**해결**:
1. 한 번에 너무 많은 문서 생성 피하기
2. 문서 생성 후 페이지 새로고침

---

## 10. 개발자 진단 도구

### 서버 로그 상세 출력

`server/src/index.ts`에 다음 추가:
```typescript
app.use((req, res, next) => {
  console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`)
  next()
})
```

### API 테스트 (curl)

```bash
# 프로젝트 목록 조회
curl http://localhost:4000/api/projects

# 템플릿 목록 조회
curl http://localhost:4000/api/templates

# 헬스 체크
curl http://localhost:4000/api/health

# 드라이브 목록 조회 (신규)
curl http://localhost:4000/api/analyze/drives

# 폴더 탐색 (신규)
curl "http://localhost:4000/api/analyze/browse?path=C:\Users"

# 폴더 분석 (신규)
curl -X POST http://localhost:4000/api/analyze/folder ^
  -H "Content-Type: application/json" ^
  -d "{\"folderPath\": \"C:\\Projects\\my-project\"}"
```

### 데이터 초기화

```bash
# 모든 데이터 초기화 (주의!)
echo {"projects":[],"templates":[]} > data/store.json

# 템플릿 파일 모두 삭제
del templates\uploads\*
```

### 로그 확인 위치

| 구분 | 위치 |
|------|------|
| 서버 로그 | 서버 실행 터미널 |
| 클라이언트 로그 | 브라우저 개발자 도구 > Console |
| API 요청/응답 | 브라우저 개발자 도구 > Network |
| 세션 정보 | 브라우저 개발자 도구 > Application > Session Storage |

---

## 자주 묻는 질문 (FAQ)

### Q: 프로젝트 분석과 수동 등록의 차이는?

**A**:
- **수동 등록**: 모든 정보를 직접 입력
- **폴더 분석**: 기존 프로젝트 폴더에서 자동 추출 후 검토/수정

### Q: 어떤 프로젝트가 분석에 적합한가요?

**A**: 다음 파일이 있는 프로젝트가 가장 적합합니다:
- README.md (프로젝트 설명)
- package.json (Node.js) 또는 pom.xml (Java)
- PRD.md (요구사항 문서)
- WBS.md (작업 분해 구조)

### Q: PDF 대신 DOCX를 권장하는 이유는?

**A**:
- PDF 생성기는 하드코딩된 레이아웃 사용
- 템플릿 디자인이 반영되지 않음
- 한글 폰트 문제 발생 가능
- **권장**: DOCX 생성 후 Word에서 PDF로 변환

### Q: 폴더에 저장 기능은 언제 사용하나요?

**A**:
- 여러 문서를 특정 폴더에 일괄 저장할 때
- 프로젝트 산출물 폴더에 직접 저장할 때
- 다운로드 폴더가 아닌 다른 위치에 저장할 때

---

*문서 버전: 2.0*
*최종 수정: 2024.12.21*
*프로젝트 분석 기능 트러블슈팅 추가*
